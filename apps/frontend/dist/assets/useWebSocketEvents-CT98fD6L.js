import{importShared as b}from"./__federation_fn_import-CJIdJiQv.js";import{l as h}from"./index-BDGyx5_k.js";const{useCallback:l,useEffect:m,useRef:d,useState:S}=await b("react");let s=null,a=0;function g(){const r="http://localhost:8787",o=new URL(r);return`${o.protocol==="https:"?"wss:":"ws:"}//${o.host}`}function C(){if(!s){const r=g();s=h(r,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:1/0})}return s}function y(){const[r,o]=S(!1),i=d(null),c=d(new Map);m(()=>{a++;const t=C();i.current=t;const n=()=>o(!0),e=()=>o(!1);return t.on("connect",n),t.on("disconnect",e),o(t.connected),t.connected||t.connect(),()=>{a--,t.off("connect",n),t.off("disconnect",e),a===0&&s&&(s.disconnect(),s=null)}},[]);const k=l((t,n)=>{const e=i.current;if(!e)return console.warn("[WebSocket] Cannot subscribe: socket not initialized"),()=>{};c.current.has(t)||c.current.set(t,new Set),c.current.get(t)?.add(n);const f=u=>{c.current.get(t)?.has(n)&&n(u)};return e.on(t,f),()=>{e.off(t,f);const u=c.current.get(t);u?.delete(n),u?.size===0&&c.current.delete(t)}},[]),p=l((t,n)=>{const e=i.current;if(!e?.connected){console.warn("[WebSocket] Cannot emit: socket not connected");return}e.emit(t,n)},[]),w=l(()=>{const t=i.current;t&&t.disconnect()},[]);return{connected:r,subscribe:k,emit:p,disconnect:w}}export{y as u};
//# sourceMappingURL=useWebSocketEvents-CT98fD6L.js.map
