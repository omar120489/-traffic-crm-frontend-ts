import{importShared as b}from"./__federation_fn_import-CJIdJiQv.js";import{l as w}from"./index-BDGyx5_k.js";const{useCallback:a,useEffect:S,useRef:d,useState:g}=await b("react");let o=null,l=0;function h(){return"wss://api.example.com/ws"}function C(){if(!o){const s=h();o=w(s,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:1/0})}return o}function y(){const[s,u]=g(!1),r=d(null),c=d(new Map);S(()=>{l++;const n=C();r.current=n;const e=()=>u(!0),t=()=>u(!1);return n.on("connect",e),n.on("disconnect",t),u(n.connected),n.connected||n.connect(),()=>{l--,n.off("connect",e),n.off("disconnect",t),l===0&&o&&(o.disconnect(),o=null)}},[]);const k=a((n,e)=>{const t=r.current;if(!t)return console.warn("[WebSocket] Cannot subscribe: socket not initialized"),()=>{};c.current.has(n)||c.current.set(n,new Set),c.current.get(n)?.add(e);const f=i=>{c.current.get(n)?.has(e)&&e(i)};return t.on(n,f),()=>{t.off(n,f);const i=c.current.get(n);i?.delete(e),i?.size===0&&c.current.delete(n)}},[]),p=a((n,e)=>{const t=r.current;if(!t?.connected){console.warn("[WebSocket] Cannot emit: socket not connected");return}t.emit(n,e)},[]),m=a(()=>{const n=r.current;n&&n.disconnect()},[]);return{connected:s,subscribe:k,emit:p,disconnect:m}}export{y as u};
//# sourceMappingURL=useWebSocketEvents-BHTNCTky.js.map
